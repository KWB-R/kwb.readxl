---
title: "Read Raw Text Information from Excel Files"
author: "Hauke Sonnenberg"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Tutorial}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This package provides functions to read data from Microsoft Excel files. It uses
the package [readxl](https://readxl.tidyverse.org/) under the hood. In contrast
to the default behaviour of readxl the functions in this package read the raw
text information that are contained in the sheets. No type conversions are
performed and all values will keep their original position in the cell grid. 
For example, a value in cell A3 will be returned in `m[3, 1]` with `m` being the
result matrix returned for one Excel sheet. By default, the `read_excel()` 
function of the readxl package would return this value in the first row of the
reuturned data frame, given that the first rows are empty. This may be useful
in some cases but for validation purposes I prefer to keep the original 
positions.

## Reading Table Data from a Spreadsheet Program

As MS Excel is a spreadsheet program, it does not really know where a table 
starts and where it ends and it does not clearly assign a type to a column. 
Instead, each cell can have its own type so that there can be cells of different 
types in one and the same column. However, functions such as 
`readxl::read_excel` try to communicate with Excel as if it was a database
management system. For each column the values in the first few rows of the 
column are inspected and the type of the column is guessed. Then, all values
in the column are tried to be converted to the guessed type. This leads to 
conversion errors, e.g. if the first few values look numeric but the column
contains text values, such as `"< 0.0001"` further down. In the returned data 
frame the text value will be removed, ie. set to `NA`. This package avoids these
data losses as it keeps the original (text) information and lets the user decide
what to do.

## Read example file with readxl

Let's check this out by reading the content from an example Excel file.

```{r}
# Path to example Excel file
file <- system.file("extdata/example_2.xlsx", package = "kwb.readxl")

# Read the first sheet with readxl::read_excel
data <- readxl::read_excel(file)

# Show the first rows: The first empty rows were skipped
head(data)

# Show the structure: The value column is numeric
str(data)
```

[![table top](images/example_2_top.png)]()
[![table top](images/example_2_bottom.png)]()

## Read example file with kwb.readxl
